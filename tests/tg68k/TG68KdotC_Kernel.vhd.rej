--- TG68KdotC_Kernel.vhd	2015-09-18 16:28:03.199044376 +0200
+++ /dev/null
@@ -2439,17 +2439,22 @@
 							set_exec(opcBF) <= '1';
 							IF opcode(10)='1' OR opcode(8)='0' THEN
 								set_exec(opcBFwb) <= '1';
---							END IF;	
---							IF opcode(10 downto 8)="111" THEN
+                                                                IF opcode(10 downto 8)/="111" THEN -- bfins
+                                                                  set_exec(ea_data_OP2) <= '1'; --TH for the flags
+                                                                END IF;
 								set_exec(ea_data_OP1) <= '1';
 							END IF;	
+
+                                                        -- BFCHG, BFCLR, BFSET, BFINS
 							IF opcode(10 downto 8)="010" OR opcode(10 downto 8)="100" OR opcode(10 downto 8)="110" OR opcode(10 downto 8)="111" THEN
 								write_back <= '1';
 							END IF;	
 							ea_only <= '1';
+                                                        -- BFEXTU, BFEXTS, BFFFO
 							IF opcode(10 downto 8)="001" OR opcode(10 downto 8)="011" OR opcode(10 downto 8)="101" THEN
 								set_exec(Regwrena) <= '1';
 							END IF;	
+                                                        -- register target
 							IF opcode(4 downto 3)="00" THEN
 								set_exec(Regwrena) <= '1';
 								IF exec(ea_build)='1' THEN
@@ -2476,9 +2481,10 @@
 -- BFINS  D1,(A0)	s2ndHbits <<D1 -> (A0)
 -- BFEXT  (A0),D1	        >>(A0) -> D1 d2ndHbits
 							IF setexecOPC='1' THEN  
+                                                                -- BFINS
 								IF opcode(10 downto 8)="111" THEN	--BFINS
 									source_2ndHbits <= '1';
-								ELSE	
+								ELSIF opcode(10 downto 8)="001" or opcode(10 downto 8)="011" THEN	--BFEXT
 									source_lowbits <= '1';
 									dest_2ndHbits <= '1';
 								END IF;	
@@ -2590,7 +2596,6 @@
 					set(get_ea_now) <='1';
 					setdisp <= '1';		--word
 					setnextpass <= '1';
-					
 				WHEN ld_AnXn1 =>		-- d(An,Xn)=>, --d(PC,Xn)=>
 					IF brief(8)='0' OR extAddr_Mode=0 OR (cpu(1)='0' AND extAddr_Mode=2) THEN
 						setdisp <= '1';		--byte	
